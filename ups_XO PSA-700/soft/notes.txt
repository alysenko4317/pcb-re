Я так і не знайшов, у чому проблема з моєю платою.
Симптоми: інвертор стартує і працює кілька секунд, навантаження — лампочка 40 Вт,
плавно загоряється і плавно гасне. Здається, за схемою всі апаратні захисти не активні.
Також помітив, що імпульси на синхронний випрямляч від МК припиняють надходити
буквально через 0,5 с після запуску, хоча на ключі первинки та на формувач синуса
імпульси йдуть усі 2 секунди, поки інвертор працює. Випрямляч починає роботу,
ШІМ починає з вузьких імпульсів, поступово розширюється, і, схоже, коли
досягає робочої ширини — все вимикається. Імпульси вимикає сам МК.

Частота ШІМ перетворювача 24В → 400В — 25 кГц.

Я хотів обдурити головний МК — подати йому потік UART не з CHIPSEA, а свою симуляцію,
спробувати погратися зі значеннями — можливо, справа в них, бо це фактично єдиний
засіб зворотного зв’язку головного МК з HV-частиною. Але щоб повністю відключити
HV (для безпеки експериментів), потрібно ще й емулювати трансформатор струму,
який стоїть на виході інвертора, бо МК використовує його сигнал як зворотний
зв’язок з інвертором. Вхід МК підключений до резистивного дільника, і 2,5 В
відповідає нульовій точці. Відповідно, сигнал із трансформатора струму
зміщує цей потенціал вгору або вниз за синусоїдальним законом, МК, імовірно,
контролює і амплітуду, і фазу.
Я пробував подавати на нього напругу від мережі — у такому випадку формувач
синуса стартує жорстко (не плавно), потім починається стадія плавного вимкнення
(бо моя плата глючна — інвертор працює 2 с), але оскільки МК бачить,
що сигнал із трансформатора не зникає під час плавного вимкнення,
він незабаром повторює спробу запуску. І знову, і знову.
Тобто, щоб симулювати цей сигнал, потрібно реалізувати не зовсім просту емульовану
синусоїду, яку подавати на вхід МК синхронно з імпульсами ШІМ на затворах формувача
синуса — щоб МК думав, що формувач синуса працює, дросель накачується тощо.

Окремо варто зазначити реалізацію синхронного випрямляча у вторинці силового трансформатора.
Особливість у тому, що МК, судячи з усього, керує цим випрямлячем «наосліп».
І затворами ключів у первинці, і випрямлячем на MOSFET'ах у вторинці керує безпосередньо
головний МК, але він не має зв’язку з HV-частиною в режимі реального часу.
Все, що він може отримати з HV — це результати вимірювань від CHIPSEA,
а саме: потенціал +400 В, потенціал +12 В (допоміжна вторинка після діодного моста),
зміщення «землі». Ці дані надходять кожні 50 мс, що досить рідко з огляду на
частоту роботи підвищуючого перетворювача 25 кГц. Це означає, що правильні пари MOSFET'ів
у випрямлячі вмикаються фактично навмання, бо жодного датчика струму, який би
відстежував фазу, немає. Можливо, головний МК лише опосередковано визначає проблему —
наприклад, якщо «земля» зникає, він розуміє, що втрачає фазу…